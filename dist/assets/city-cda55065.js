import{c as ie,m as Y,n as H,t as ke,h as ue,e as oe,r as Ze,d as le,u as et,a as l,y as D,I as te,w as ce,ak as Ce,al as Re,am as tt,an as nt,W as at,M as it,U as pe,q as O,ao as $e,ap as ot,b as q,f as we,F as lt,aq as ct,k as me,C as ee,D as Pe,v as ve,ar as Te,as as rt,p as ne,K as Be,at as Me,au as st,av as ut,aw as dt,G as ft,R as gt,ax as ht,a2 as be,_ as ye,x as mt,ay as vt,Q as Ve,a3 as De,aa as Oe,a4 as L,a5 as j,aj as _e,a8 as de,H as J,af as ae,ad as bt,ai as xe,ab as yt,ae as Ae,z as _t,A as xt}from"./index-91b6ba5b.js";/* empty css              */import{a as fe,u as kt}from"./index-21f726b7.js";import{u as ze}from"./city-ef05fe67.js";import{u as Ne,T as Ct,a as It}from"./index-c6bb5663.js";import"./index-f6b61cc7.js";import"./index-c074a323.js";const[St,X]=ie("cell"),Fe={tag:Y("div"),icon:String,size:String,title:H,value:H,label:H,center:Boolean,isLink:Boolean,border:ke,required:Boolean,iconPrefix:String,valueClass:ue,labelClass:ue,titleClass:ue,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},wt=oe({},Fe,Ze);var Tt=le({name:St,props:wt,setup(e,{slots:n}){const a=et(),d=()=>{if(n.label||D(e.label))return l("div",{class:[X("label"),e.labelClass]},[n.label?n.label():e.label])},o=()=>{var i;if(n.title||D(e.title)){const h=(i=n.title)==null?void 0:i.call(n);return Array.isArray(h)&&h.length===0?void 0:l("div",{class:[X("title"),e.titleClass],style:e.titleStyle},[h||l("span",null,[e.title]),d()])}},c=()=>{const i=n.value||n.default;if(i||D(e.value))return l("div",{class:[X("value"),e.valueClass]},[i?i():l("span",null,[e.value])])},v=()=>{if(n.icon)return n.icon();if(e.icon)return l(te,{name:e.icon,class:X("left-icon"),classPrefix:e.iconPrefix},null)},b=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const i=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(te,{name:i,class:X("right-icon")},null)}};return()=>{var i;const{tag:h,size:r,center:I,border:y,isLink:k,required:S}=e,A=(i=e.clickable)!=null?i:k,$={center:I,required:S,clickable:A,borderless:!y};return r&&($[r]=!!r),l(h,{class:X($),role:A?"button":void 0,tabindex:A?0:void 0,onClick:a},{default:()=>{var P;return[v(),o(),c(),b(),(P=n.extra)==null?void 0:P.call(n)]}})}}});const We=ce(Tt);function je(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Vt(e,n){if(je(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function At(e,n){return new Promise(a=>{const d=n.validator(e,n);if(tt(d)){d.then(a);return}a(d)})}function Ee(e,n){const{message:a}=n;return nt(a)?a(e,n):a||""}function Et({target:e}){e.composing=!0}function Le({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Lt(e,n){const a=Ce();e.style.height="auto";let d=e.scrollHeight;if(at(n)){const{maxHeight:o,minHeight:c}=n;o!==void 0&&(d=Math.min(d,o)),c!==void 0&&(d=Math.max(d,c))}d&&(e.style.height=`${d}px`,Re(a))}function Rt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function W(e){return[...e].length}function ge(e,n){return[...e].slice(0,n).join("")}const[pt,E]=ie("field"),Ie={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:H,formatter:Function,clearIcon:Y("clear"),modelValue:it(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,spellcheck:{type:Boolean,default:null},clearTrigger:Y("focus"),formatTrigger:Y("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},$t=oe({},Fe,Ie,{rows:H,type:Y("text"),rules:Array,autosize:[Boolean,Object],labelWidth:H,labelClass:ue,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Pt=le({name:pt,props:$t,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const d=Ne(),o=pe({status:"unvalidated",focused:!1,validateMessage:""}),c=O(),v=O(),b=O(),{parent:i}=$e(ot),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},r=t=>{if(D(e[t]))return e[t];if(i&&D(i.props[t]))return i.props[t]},I=q(()=>{const t=r("readonly");if(e.clearable&&!t){const f=h()!=="",u=e.clearTrigger==="always"||e.clearTrigger==="focus"&&o.focused;return f&&u}return!1}),y=q(()=>b.value&&a.input?b.value():e.modelValue),k=t=>t.reduce((f,u)=>f.then(()=>{if(o.status==="failed")return;let{value:m}=y;if(u.formatter&&(m=u.formatter(m,u)),!Vt(m,u)){o.status="failed",o.validateMessage=Ee(m,u);return}if(u.validator)return je(m)&&u.validateEmpty===!1?void 0:At(m,u).then(x=>{x&&typeof x=="string"?(o.status="failed",o.validateMessage=x):x===!1&&(o.status="failed",o.validateMessage=Ee(m,u))})}),Promise.resolve()),S=()=>{o.status="unvalidated",o.validateMessage=""},A=()=>n("endValidate",{status:o.status,message:o.validateMessage}),$=(t=e.rules)=>new Promise(f=>{S(),t?(n("startValidate"),k(t).then(()=>{o.status==="failed"?(f({name:e.name,message:o.validateMessage}),A()):(o.status="passed",f(),A())})):f()}),P=t=>{if(i&&e.rules){const{validateTrigger:f}=i.props,u=Te(f).includes(t),m=e.rules.filter(x=>x.trigger?Te(x.trigger).includes(t):u);m.length&&$(m)}},G=t=>{var f;const{maxlength:u}=e;if(D(u)&&W(t)>+u){const m=h();if(m&&W(m)===+u)return m;const x=(f=c.value)==null?void 0:f.selectionEnd;if(o.focused&&x){const V=[...t],p=V.length-+u;return V.splice(x-p,p),V.join("")}return ge(t,+u)}return t},z=(t,f="onChange")=>{const u=t;t=G(t);const m=W(u)-W(t);if(e.type==="number"||e.type==="digit"){const V=e.type==="number";t=rt(t,V,V)}let x=0;if(e.formatter&&f===e.formatTrigger){const{formatter:V,maxlength:p}=e;if(t=V(t),D(p)&&W(t)>+p&&(t=ge(t,+p)),c.value&&o.focused){const{selectionEnd:se}=c.value,Se=ge(u,se);x=W(V(Se))-W(Se)}}if(c.value&&c.value.value!==t)if(o.focused){let{selectionStart:V,selectionEnd:p}=c.value;if(c.value.value=t,D(V)&&D(p)){const se=W(t);m?(V-=m,p-=m):x&&(V+=x,p+=x),c.value.setSelectionRange(Math.min(V,se),Math.min(p,se))}}else c.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},Q=t=>{t.target.composing||z(t.target.value)},s=()=>{var t;return(t=c.value)==null?void 0:t.blur()},K=()=>{var t;return(t=c.value)==null?void 0:t.focus()},N=()=>{const t=c.value;e.type==="textarea"&&e.autosize&&t&&Lt(t,e.autosize)},g=t=>{o.focused=!0,n("focus",t),ee(N),r("readonly")&&s()},_=t=>{o.focused=!1,z(h(),"onBlur"),n("blur",t),!r("readonly")&&(P("onBlur"),ee(N),st())},C=t=>n("clickInput",t),T=t=>n("clickLeftIcon",t),w=t=>n("clickRightIcon",t),B=t=>{ne(t),n("update:modelValue",""),n("clear",t)},F=q(()=>{if(typeof e.error=="boolean")return e.error;if(i&&i.props.showError&&o.status==="failed")return!0}),M=q(()=>{const t=r("labelWidth"),f=r("labelAlign");if(t&&f!=="top")return{width:we(t)}}),R=t=>{t.keyCode===13&&(!(i&&i.props.submitOnEnter)&&e.type!=="textarea"&&ne(t),e.type==="search"&&s()),n("keypress",t)},re=()=>e.id||`${d}-input`,U=()=>o.status,Ke=()=>{const t=E("control",[r("inputAlign"),{error:F.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return l("div",{class:t,onClick:C},[a.input()]);const f={id:re(),ref:c,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:r("disabled"),readonly:r("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${d}-label`:void 0,onBlur:_,onFocus:g,onInput:Q,onClick:C,onChange:Le,onKeypress:R,onCompositionend:Le,onCompositionstart:Et};return e.type==="textarea"?l("textarea",f,null):l("input",Be(Rt(e.type),f),null)},Ue=()=>{const t=a["left-icon"];if(e.leftIcon||t)return l("div",{class:E("left-icon"),onClick:T},[t?t():l(te,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ye=()=>{const t=a["right-icon"];if(e.rightIcon||t)return l("div",{class:E("right-icon"),onClick:w},[t?t():l(te,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ge=()=>{if(e.showWordLimit&&e.maxlength){const t=W(h());return l("div",{class:E("word-limit")},[l("span",{class:E("word-num")},[t]),Me("/"),e.maxlength])}},Xe=()=>{if(i&&i.props.showErrorMessage===!1)return;const t=e.errorMessage||o.validateMessage;if(t){const f=a["error-message"],u=r("errorMessageAlign");return l("div",{class:E("error-message",u)},[f?f({message:t}):t])}},Je=()=>{const t=r("labelWidth"),f=r("labelAlign"),u=r("colon")?":":"";if(a.label)return[a.label(),u];if(e.label)return l("label",{id:`${d}-label`,for:a.input?void 0:re(),onClick:m=>{ne(m),K()},style:f==="top"&&t?{width:we(t)}:void 0},[e.label+u])},Qe=()=>[l("div",{class:E("body")},[Ke(),I.value&&l(te,{ref:v,name:e.clearIcon,class:E("clear")},null),Ye(),a.button&&l("div",{class:E("button")},[a.button()])]),Ge(),Xe()];return fe({blur:s,focus:K,validate:$,formValue:y,resetValidation:S,getValidationStatus:U}),lt(ct,{customValue:b,resetValidation:S,validateWithTrigger:P}),me(()=>e.modelValue,()=>{z(h()),S(),P("onChange"),ee(N)}),Pe(()=>{z(h(),e.formatTrigger),ee(N)}),ve("touchstart",B,{target:q(()=>{var t;return(t=v.value)==null?void 0:t.$el})}),()=>{const t=r("disabled"),f=r("labelAlign"),u=Ue(),m=()=>{const x=Je();return f==="top"?[u,x].filter(Boolean):x||[]};return l(We,{size:e.size,class:E({error:F.value,disabled:t,[`label-${f}`]:f}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:M.value,valueClass:E("value"),titleClass:[E("label",[f,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:u&&f!=="top"?()=>u:null,title:m,value:Qe,extra:a.extra})}}});const Bt=ce(Pt);function Mt(){const e="A".charCodeAt(0);return Array(26).fill("").map((a,d)=>String.fromCharCode(e+d))}const[qe,he]=ie("index-bar"),Dt={sticky:ke,zIndex:H,teleport:[String,Object],highlightColor:String,stickyOffsetTop:gt(0),indexList:{type:Array,default:Mt}},He=Symbol(qe);var Ot=le({name:qe,props:Dt,emits:["select","change"],setup(e,{emit:n,slots:a}){const d=O(),o=O(),c=O(""),v=kt(),b=ut(d),{children:i,linkChildren:h}=dt(He);let r;h({props:e});const I=q(()=>{if(D(e.zIndex))return{zIndex:+e.zIndex+1}}),y=q(()=>{if(e.highlightColor)return{color:e.highlightColor}}),k=(g,_)=>{for(let C=i.length-1;C>=0;C--){const T=C>0?_[C-1].height:0,w=e.sticky?T+e.stickyOffsetTop:0;if(g+w>=_[C].top)return C}return-1},S=g=>i.find(_=>String(_.index)===g),A=()=>{if(ht(d))return;const{sticky:g,indexList:_}=e,C=be(b.value),T=ye(b),w=i.map(F=>F.getRect(b.value,T));let B=-1;if(r){const F=S(r);if(F){const M=F.getRect(b.value,T);B=k(M.top,w)}}else B=k(C,w);c.value=_[B],g&&i.forEach((F,M)=>{const{state:R,$el:re}=F;if(M===B||M===B-1){const U=re.getBoundingClientRect();R.left=U.left,R.width=U.width}else R.left=null,R.width=null;if(M===B)R.active=!0,R.top=Math.max(e.stickyOffsetTop,w[M].top-C)+T.top;else if(M===B-1&&r===""){const U=w[B].top-C;R.active=U>0,R.top=U+T.top-w[M].height}else R.active=!1}),r=""},$=()=>{ee(A)};ve("scroll",A,{target:b,passive:!0}),Pe($),me(()=>e.indexList,$),me(c,g=>{g&&n("change",g)});const P=()=>e.indexList.map(g=>{const _=g===c.value;return l("span",{class:he("index",{active:_}),style:_?y.value:void 0,"data-index":g},[g])}),G=g=>{r=String(g);const _=S(r);if(_){const C=be(b.value),T=ye(b),{offsetHeight:w}=document.documentElement;if(_.$el.scrollIntoView(),C===w-T.height){A();return}e.sticky&&e.stickyOffsetTop&&Re(Ce()-e.stickyOffsetTop),n("select",_.index)}},z=g=>{const{index:_}=g.dataset;_&&G(_)},Q=g=>{z(g.target)};let s;const K=g=>{if(v.move(g),v.isVertical()){ne(g);const{clientX:_,clientY:C}=g.touches[0],T=document.elementFromPoint(_,C);if(T){const{index:w}=T.dataset;w&&s!==w&&(s=w,z(T))}}},N=()=>l("div",{ref:o,class:he("sidebar"),style:I.value,onClick:Q,onTouchstartPassive:v.start},[P()]);return fe({scrollTo:G}),ve("touchmove",K,{target:o}),()=>{var g;return l("div",{ref:d,class:he()},[e.teleport?l(ft,{to:e.teleport},{default:()=>[N()]}):N(),(g=a.default)==null?void 0:g.call(a)])}}});const[zt,Nt]=ie("index-anchor"),Ft={index:H};var Wt=le({name:zt,props:Ft,setup(e,{slots:n}){const a=pe({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),d=O(),{parent:o}=$e(He);if(!o)return;const c=()=>a.active&&o.props.sticky,v=q(()=>{const{zIndex:i,highlightColor:h}=o.props;if(c())return oe(mt(i),{left:a.left?`${a.left}px`:void 0,width:a.width?`${a.width}px`:void 0,transform:a.top?`translate3d(0, ${a.top}px, 0)`:void 0,color:h})});return fe({state:a,getRect:(i,h)=>{const r=ye(d);return a.rect.height=r.height,i===window||i===document.body?a.rect.top=r.top+Ce():a.rect.top=r.top+be(i)-h.top,a.rect}}),()=>{const i=c();return l("div",{ref:d,style:{height:i?`${a.rect.height}px`:void 0}},[l("div",{style:v.value,class:[Nt({sticky:i}),{[vt]:i}]},[n.default?n.default():e.index])])}}});const jt=ce(Wt),qt=ce(Ot),[Ht,Z,Kt]=ie("search"),Ut=oe({},Ie,{label:String,shape:Y("square"),leftIcon:Y("search"),clearable:ke,actionText:String,background:String,showAction:Boolean});var Yt=le({name:Ht,props:Ut,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:d}){const o=Ne(),c=O(),v=()=>{a.action||(n("update:modelValue",""),n("cancel"))},b=s=>{s.keyCode===13&&(ne(s),n("search",e.modelValue))},i=()=>e.id||`${o}-input`,h=()=>{if(a.label||e.label)return l("label",{class:Z("label"),for:i()},[a.label?a.label():e.label])},r=()=>{if(e.showAction){const s=e.actionText||Kt("cancel");return l("div",{class:Z("action"),role:"button",tabindex:0,onClick:v},[a.action?a.action():s])}},I=()=>{var s;return(s=c.value)==null?void 0:s.blur()},y=()=>{var s;return(s=c.value)==null?void 0:s.focus()},k=s=>n("blur",s),S=s=>n("focus",s),A=s=>n("clear",s),$=s=>n("clickInput",s),P=s=>n("clickLeftIcon",s),G=s=>n("clickRightIcon",s),z=Object.keys(Ie),Q=()=>{const s=oe({},d,Ve(e,z),{id:i()}),K=N=>n("update:modelValue",N);return l(Bt,Be({ref:c,type:"search",class:Z("field"),border:!1,onBlur:k,onFocus:S,onClear:A,onKeypress:b,onClickInput:$,onClickLeftIcon:P,onClickRightIcon:G,"onUpdate:modelValue":K},s),Ve(a,["left-icon","right-icon"]))};return fe({focus:y,blur:I}),()=>{var s;return l("div",{class:Z({"show-action":e.showAction}),style:{background:e.background}},[(s=a.left)==null?void 0:s.call(a),l("div",{class:Z("content",e.shape)},[h(),Q()]),r()])}}});const Gt=ce(Yt);const Xt={class:"city-group"},Jt={class:"list"},Qt=["onClick"],Zt={class:"list"},en={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(e){const n=e,a=q(()=>{const v=n.groupData.cities.map(b=>b.group);return v.unshift("#"),v}),d=ze(),o=Oe(),c=v=>{d.currentCity=v,o.back()};return(v,b)=>{const i=jt,h=We,r=qt;return L(),j("div",Xt,[l(r,{sticky:!0,"highlight-color":"#ff9854","index-list":a.value},{default:_e(()=>[l(i,{index:"#"},{default:_e(()=>[Me("热门")]),_:1}),de("div",Jt,[(L(!0),j(J,null,ae(e.groupData.hotCities,(I,y)=>(L(),j("div",{key:y,class:"city",onClick:k=>c(I)},bt(I.cityName),9,Qt))),128))]),(L(!0),j(J,null,ae(e.groupData.cities,(I,y)=>(L(),j(J,{key:y},[l(i,{index:I.group},null,8,["index"]),de("div",Zt,[(L(!0),j(J,null,ae(I.cities,(k,S)=>(L(),xe(h,{key:S,title:k.cityName,onClick:A=>c(k)},null,8,["title","onClick"]))),128))])],64))),128))]),_:1},8,["index-list"])])}}},tn=De(en,[["__scopeId","data-v-3994e81a"]]);const nn={class:"city top-page"},an={class:"top"},on={class:"content"},ln={__name:"city",setup(e){const n=Oe(),a=O(""),d=()=>{n.back()},o=O(),c=ze();c.fetchAllCitiesData();const{allCities:v}=yt(c);return(b,i)=>{const h=Gt,r=It,I=Ct;return L(),j("div",nn,[de("div",an,[l(h,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=y=>a.value=y),placeholder:"城市/区域/位置","show-action":"",shape:"round",onCancel:d},null,8,["modelValue"]),l(I,{active:o.value,"onUpdate:active":i[1]||(i[1]=y=>o.value=y),color:"#ff9854","line-height":"3","line-width":"80"},{default:_e(()=>[(L(!0),j(J,null,ae(Ae(v),(y,k,S)=>(L(),xe(r,{key:k,title:y.title,name:k},null,8,["title","name"]))),128))]),_:1},8,["active"])]),de("div",on,[(L(!0),j(J,null,ae(Ae(v),(y,k,S)=>_t((L(),xe(tn,{"group-data":y},null,8,["group-data"])),[[xt,o.value===k]])),256))])])}}},hn=De(ln,[["__scopeId","data-v-7439ba99"]]);export{hn as default};
